import discord
from discord.ext import commands
from data.data_manager import DataManager

class YouTubeCommands(commands.Cog):
    def __init__(self, bot):
        self.bot = bot
        self.data_manager = DataManager()

    @discord.app_commands.command(
        name="adicionar_youtube",
        description="Vincula seu canal do YouTube para monitoramento de lives"
    )
    async def add_youtube(self, interaction: discord.Interaction, username: str):
        self.data_manager.add_user(
            interaction.guild.id,
            interaction.user.id,
            youtube_name=username.lower().strip()
        )
        await interaction.response.send_message(
            f"✅ YouTube `{username}` vinculado com sucesso!",
            ephemeral=True
        )

    @discord.app_commands.command(
        name="remover_youtube",
        description="Remove seu canal do YouTube do monitoramento"
    )
    async def remove_youtube(self, interaction: discord.Interaction):
        success = self.data_manager.remove_user_platform(
            interaction.guild.id,
            interaction.user.id,
            platform="youtube"
        )
        response = "✅ YouTube removido!" if success else "ℹ️ Nenhum canal YouTube vinculado."
        await interaction.response.send_message(response, ephemeral=True)

async def setup(bot):
    await bot.add_cog(YouTubeCommands(bot))
